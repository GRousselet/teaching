---
title: "Bordeaux 2019 - robust stats - part 3: sampling distributions"
author: "Guillaume A. Rousselet"
date: "`r Sys.Date()`"
output:
  pdf_document:
    fig_caption: no
    number_sections: no
    toc: yes
    toc_depth: 2
---

```{r message=FALSE, warning=FALSE}
# dependencies
library(ggplot2)
library(tibble)
```

```{r}
sessionInfo()
```

# Relationship between SEM and SD of population

Standard error of the mean = standard deviation of the sampling distribution of the sample mean

https://www.khanacademy.org/math/ap-statistics/sampling-distribution-ap/sampling-distribution-mean/v/standard-error-of-the-mean

# Reaction time example
```{r}

```

# Correlation example
```{r}

```

# Example using the mean

Sampling distributions:
theory vs. empirical results in the presence of skewness
https://stackoverflow.com/questions/51043753/overlay-histogram-with-empirical-density-and-dnorm-function

```{r}

```

# Example using the lognormal

[Blog post](https://msalganik.wordpress.com/2017/01/21/making-sense-of-the-rlnorm-function-in-r/) on how to use `rlnorm()`.

## Illustrate lognormal
```{r}
m <- 5
s <- 5
location <- log(m^2 / sqrt(s^2 + m^2))
shape <- sqrt(log(1 + (s^2 / m^2)))
x <- seq(0, 20, .05)
ggplot(as_tibble(x), aes(value)) +
  stat_function(fun = dlnorm, args = list(meanlog = location, sdlog = shape))
```

## Sample from lognormal distribution 
```{r}
set.seed(777)
m <- 5
s <- 5
location <- log(m^2 / sqrt(s^2 + m^2))
shape <- sqrt(log(1 + (s^2 / m^2)))

# population mean?
lnorm.pop.m <- mean(rlnorm(1000000, meanlog = location, sdlog = shape))

n <- 20
nsamp <- 10000
# nsamp experiments in one go + compute mean for each one:
dist.samp <- apply(matrix(rlnorm(n*nsamp, meanlog = location, sdlog = shape), nrow = nsamp), 1, mean)

v <- as_tibble(dist.samp) 
ggplot(v, aes(x = value)) +
        geom_histogram(aes(y = ..density..), 
                       bins = 40,  colour = "black", fill = "white") +
        geom_line(aes(y = ..density.., colour = "orange1"), stat = 'density', size = 1) +     
  theme(legend.position = "none",
        axis.title = element_text(size = 16),
        axis.text = element_text(size = 14),
        legend.text = element_text(size = 12),
      legend.title = element_text(size = 14)
       )
```


